- provide(:title, 'Varastotilanne')

.container
  .span12
    = render "shared/nav"

.container
  .span12
    .row.bordered
      %h2 Varastotilanne
      %table.table.table-bordered#storageTable
        %thead
          %tr
            %th Tyyppi
            %th Aine
            %th Erä
            %th Määrä yhteensä
            %th Määrät varastopaikoittain
            %th Vanhenemis pvm
        %tbody
          - @generators.each do |generator|
            - generator.batches.each do |batch|
              %tr
                %td
                  = generator.substanceType
                %td
                  = generator.genericName
                %td
                  = link_to batch.batchNumber, batch
                -if batch.amount < 10
                  %td.alert.alert-error{title:'Varastossa alle 10 tuotetta!'}
                    = batch.amount
                    %span.pull-right !!!
                - else
                  %td= batch.amount
                %td
                  - batch.hasstoragelocations.each do |storage|
                    = storage.storagelocation.name+': '+ storage.amount.to_s
                    <br/>
                - if batch.expDate < Date.today
                  %td.alert.alert-error{title:'Erän päiväys mennyt umpeen!'}
                    = batch.expDate
                    %span.pull-right !!!
                - else
                  %td= batch.expDate

  %a.nav-link{href: "#", onclick: "window.print()"}
    %i.icon-print.margin-left10
    Tulosta
